# Game Defines - Single Source of Truth for Simulation Coefficients
#
# This file externalizes all "magic numbers" from Python code, enabling:
# 1. Game designers to balance the simulation without touching code
# 2. Scenario-specific coefficient overrides
# 3. Clear documentation of what each number means
#
# Categories:
# - economy: Imperial rent extraction and value flow
# - survival: P(S|A) and P(S|R) survival calculus
# - solidarity: Consciousness transmission
# - defaults: Fallback values for entity attributes

economy:
  # Imperial rent extraction
  extraction_efficiency: 0.8        # Alpha - how efficiently core extracts value from periphery [0,1]
  comprador_cut: 0.90               # Fraction of wealth kept by comprador class (90%) - prevents Comprador Liquidation

  # Super-wages (PPP Model)
  super_wage_rate: 0.20             # Fraction of tribute paid as super-wages (20%)
  superwage_multiplier: 1.0         # PPP multiplier for labor aristocracy purchasing power
  superwage_ppp_impact: 0.5         # How much extraction translates to PPP bonus (50%)

  # Imperial rent pool (Dynamic Balance)
  initial_rent_pool: 100.0          # Starting imperial rent pool
  pool_high_threshold: 0.7          # Pool ratio for prosperity mode (70%)
  pool_low_threshold: 0.3           # Pool ratio for austerity mode (30%)
  pool_critical_threshold: 0.1      # Pool ratio for ECONOMIC_CRISIS (10%)

  # Wage bounds
  min_wage_rate: 0.05               # Minimum super-wage rate during crisis (5%)
  max_wage_rate: 0.35               # Maximum super-wage rate during prosperity (35%)

  # Client state subsidy (The Iron Lung)
  subsidy_conversion_rate: 0.1      # Rate at which wealth converts to repression (10%)
  subsidy_trigger_threshold: 0.8    # P(S|R)/P(S|A) ratio threshold for subsidy (80%)

  # Entity operational costs (The Calorie Check - must be > 0 to prevent Eden Mode)
  # LINEAR burn: cost = base_subsistence * class_multiplier (not percentage!)
  # Calibrated for 20-year (1040 tick) Hump Shape dynamics
  base_subsistence: 0.0005          # Biological floor: fixed cost per tick, scaled by class multiplier
  base_labor_power: 1.0             # Base value produced per tick by worker with full biocapacity

  # Zombie prevention (Sprint 1.X D2: High-Fidelity State)
  death_threshold: 0.001            # Wealth threshold below which entities die (failsafe)

  # Negligible value thresholds (noise filtering)
  negligible_rent: 0.01             # Rent below this threshold skips event emission
  negligible_subsidy: 0.01          # Subsidy below this threshold skips processing

  # TRPF Surrogate - Tendency of the Rate of Profit to Fall (Marx, Capital Vol. 3)
  # Models declining extraction efficiency over time without full OCC tracking
  # See ai-docs/epoch2-trpf.yaml for full OCC implementation planned for Epoch 2
  trpf_coefficient: 0.0005          # Extraction efficiency decay per tick (at 1040 ticks: 48% efficiency)
  trpf_efficiency_floor: 0.1        # Minimum extraction efficiency after TRPF decay (10%)
  rent_pool_decay: 0.002            # Background rent pool evaporation per tick

  # Bourgeoisie Decision Policy Deltas (Dynamic Balance - Sprint 3.4.4)
  # These control wage/repression changes based on imperial rent pool level and tension
  bribery_wage_delta: 0.05          # Wage increase during prosperity (BRIBERY)
  austerity_wage_delta: -0.05       # Wage cut during low pool (AUSTERITY)
  iron_fist_repression_delta: 0.10  # Repression boost during high tension (IRON_FIST)
  crisis_wage_delta: -0.15          # Emergency wage slash (CRISIS)
  crisis_repression_delta: 0.20     # Emergency repression spike (CRISIS)

  # Tension Thresholds for Bourgeoisie Decisions
  bribery_tension_threshold: 0.3    # Maximum tension for bribery policy (30%)
  iron_fist_tension_threshold: 0.5  # Minimum tension for iron fist policy (50%)

survival:
  # Acquiescence probability P(S|A)
  steepness_k: 10.0                 # Sigmoid sharpness in acquiescence probability
  default_subsistence: 0.3          # Minimum wealth for survival through compliance

  # Revolution probability P(S|R)
  default_organization: 0.1         # Fallback organization value [0,1]
  default_repression: 0.5           # Fallback repression value [0,1]
  revolution_threshold: 1.0         # Tipping point for P(S|R) formula
  repression_base: 0.5              # Base resistance to revolution in denominator

solidarity:
  # Consciousness transmission
  scaling_factor: 0.5               # Multiplier for graph edge weights affecting organization [0,2]
  activation_threshold: 0.3         # Minimum source consciousness for transmission (30%)
  mass_awakening_threshold: 0.6     # Target consciousness for MASS_AWAKENING event (60%)
  negligible_transmission: 0.01     # Threshold below which transmissions are skipped

  # Superwage impact on consciousness
  superwage_impact: 1.0             # How much imperial extraction affects Core wealth

# Behavioral economics
behavioral:
  loss_aversion_lambda: 2.25        # Kahneman-Tversky loss aversion coefficient

# Tension dynamics
tension:
  accumulation_rate: 0.05           # Rate at which tension accumulates from wealth gaps

# Consciousness drift
consciousness:
  sensitivity: 0.5                  # How quickly consciousness responds to material conditions
  decay_lambda: 0.1                 # Decay rate for consciousness without material basis

# Territory dynamics
territory:
  heat_decay_rate: 0.1              # Heat decay for LOW_PROFILE territories (10%)
  high_profile_heat_gain: 0.15      # Heat gain for HIGH_PROFILE territories (15%)
  eviction_heat_threshold: 0.8      # Heat threshold for eviction pipeline (80%)
  rent_spike_multiplier: 1.5        # Rent multiplier during eviction (1.5x)
  displacement_rate: 0.1            # Population displacement during eviction (10%)
  heat_spillover_rate: 0.05         # Heat spillover via ADJACENCY edges (5%)
  clarity_profile_coefficient: 0.3  # Clarity bonus for HIGH_PROFILE territories (30%)

# Struggle dynamics (Agency Layer - "George Floyd" Dynamic)
struggle:
  spark_probability_scale: 0.1      # Base 10% chance scaled by repression_faced
  resistance_threshold: 0.1         # Minimum agitation for uprising (10%)
  wealth_destruction_rate: 0.05     # Economic damage from uprising (5% wealth loss)
  solidarity_gain_per_uprising: 0.2 # Solidarity strength increase per uprising

  # George Jackson Bifurcation (Power Vacuum)
  jackson_threshold: 0.4            # Revolutionary capacity threshold (org * consciousness)
  revolutionary_agitation_boost: 0.5  # Agitation boost during revolutionary offensive
  fascist_identity_boost: 0.2       # National identity boost for core workers during fascist turn
  fascist_acquiescence_boost: 0.2   # Acquiescence boost for core workers during fascist turn

# Initial conditions
initial:
  worker_wealth: 0.5                # Starting wealth for periphery worker
  owner_wealth: 0.5                 # Starting wealth for core owner
  default_population: 1             # Default population for test entities (per-capita survival testing)

# Vitality coefficients (Mass Line population dynamics)
vitality:
  base_mortality_factor: 0.01       # Fraction of at-risk population that dies per tick
  inequality_impact: 1.0            # How strongly inequality affects marginal wealth (1.0=full effect)

# Topology coefficients (solidarity network phase transitions)
topology:
  gaseous_threshold: 0.1            # Percolation ratio below this = atomized (no collective action)
  condensation_threshold: 0.5       # Percolation ratio for phase transition (gaseous→liquid/solid)
  vanguard_density_threshold: 0.5   # Cadre density threshold for vanguard party (liquid→solid)

# Metabolism coefficients (Metabolic Rift - ecological limits)
metabolism:
  entropy_factor: 1.2               # Extraction costs more than it yields (thermodynamic inefficiency)
  overshoot_threshold: 1.0          # Consumption/biocapacity ratio triggering ECOLOGICAL_OVERSHOOT
  max_overshoot_ratio: 999.0        # Cap for overshoot ratio when biocapacity depleted

# Carceral equilibrium coefficients (Terminal Crisis Dynamics)
# Models transition from wage suppression to incarceration as rent pool exhausts
carceral:
  control_capacity: 4               # Prisoners one enforcer can control (1:N). US average ~4
  enforcer_fraction: 0.15           # After SUPERWAGE_CRISIS: % of former LA who become guards/cops
  proletariat_fraction: 0.85        # After SUPERWAGE_CRISIS: % of former LA who become prisoners
  revolution_threshold: 0.5         # Average prisoner organization threshold for revolution (vs genocide)
  # Phase staggering delays (ticks) - ensures temporal separation between phases
  decomposition_delay: 52           # Ticks after SUPERWAGE_CRISIS before CLASS_DECOMPOSITION (1 year)
  control_ratio_delay: 52           # Ticks after CLASS_DECOMPOSITION before checking control ratio
  terminal_decision_delay: 1        # Ticks after CONTROL_RATIO_CRISIS before TERMINAL_DECISION

# Endgame detection thresholds
endgame:
  revolutionary_percolation_threshold: 0.7    # Percolation ratio for revolutionary victory (70%)
  revolutionary_consciousness_threshold: 0.8  # Average consciousness for revolutionary victory (80%)
  ecological_overshoot_threshold: 2.0         # Overshoot ratio threshold for collapse tracking
  ecological_sustained_ticks: 5               # Consecutive ticks of overshoot before collapse
  fascist_majority_threshold: 3               # Nodes with national_identity > class_consciousness

# Precision configuration (deterministic simulation)
# Epsilon Hierarchy: GRID (1e-6) > DIVISION (1e-9) > COMPARISON (1e-10) > MACHINE (2e-16)
precision:
  decimal_places: 6                 # Quantization precision (10^-n). Default 6 = 0.000001
  rounding_mode: "ROUND_HALF_UP"    # Rounding mode for quantization
  epsilon: 0.000000001              # Division-by-zero guard (1e-9, must be < grid)
  comparison_epsilon: 0.0000000001  # Float equality tolerance (1e-10, for pytest.approx)

# Timescale configuration (weekly ticks)
timescale:
  tick_duration_days: 7             # Real-world days per tick. Default 7 = weekly
  weeks_per_year: 52                # Weeks per year for flow conversion
